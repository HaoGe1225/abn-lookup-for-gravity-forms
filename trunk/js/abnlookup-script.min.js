function itsg_gf_abnlookup_function(e,a,i){var s=gf_abnlookup_settings.ajax_url,t=gf_abnlookup_settings.validation_message_loading,o=gf_abnlookup_settings.validation_message_not_valid,n=gf_abnlookup_settings.validation_message_error_communicating,l=gf_abnlookup_settings.validation_message_11_char,d=gf_abnlookup_settings.text_checking,r=gf_abnlookup_settings.text_check_abn,_=gf_abnlookup_settings.gst_value_yes,p=gf_abnlookup_settings.gst_value_no,g=gf_abnlookup_settings.lookup_timeout,c=gf_abnlookup_settings.lookup_retries;!function(a){"use strict";var i=!1,u=a(".gform_abnlookup_field_"+e+' input[type="text"]'),h=a(".gform_abnlookup_field_"+e+" .gfield_description.validation_message"),f=a(".itsg_abnlookup_response_"+e),y=a(".itsg_abnlookup_checkabn_"+e),v=a(".gform_abnlookup_entity_gst_field_"+e),m=a(".gform_abnlookup_entity_gst_field_"+e+' input[value="'+_+'"]'),b=a(".gform_abnlookup_entity_gst_field_"+e+' input[value="'+p+'"]'),k=a(".gform_abnlookup_entity_type_field_"+e),C=a(".gform_abnlookup_entity_type_field_"+e+" input"),x=a(".gform_abnlookup_entity_status_field_"+e),E=a(".gform_abnlookup_entity_status_field_"+e+" input"),N=a(".gform_abnlookup_entity_name_field_"+e),w=a(".gform_abnlookup_entity_name_field_"+e+" input"),A=a(".gform_abnlookup_entity_postcode_field_"+e),S=a(".gform_abnlookup_entity_postcode_field_"+e+" input"),D=a(".gform_abnlookup_entity_state_field_"+e),T=a(".gform_abnlookup_entity_state_field_"+e+" input"),j=a(".gform_abnlookup_entity_effective_from_field_"+e),F=a(".gform_abnlookup_entity_effective_from_field_"+e+" input"),Q=a(".gform_abnlookup_gst_effective_from_field_"+e),B=a(".gform_abnlookup_gst_effective_from_field_"+e+" input");""!==f.html()?((m.is(":visible")&&1!=m.prop("checked")&&1!=b.prop("checked")||C.is(":visible")&&""==C.val()||E.is(":visible")&&""==E.val()||w.is(":visible")&&""==w.val()||S.is(":visible")&&""==S.val()||T.is(":visible")&&""==T.val()||F.is(":visible")&&""==F.val()||B.is(":visible")&&""==B.val())&&u.trigger("change"),m.is(":checked")?b.prop("disabled",!0):b.is(":checked")&&m.prop("disabled",!0),C.prop("readonly",!0),E.prop("readonly",!0),w.prop("readonly",!0),S.prop("readonly",!0),T.prop("readonly",!0),F.prop("readonly",!0),B.prop("readonly",!0)):(v.closest("li.gfield").hide(),k.closest("li.gfield").hide(),x.closest("li.gfield").hide(),N.closest("li.gfield").hide(),A.closest("li.gfield").hide(),D.closest("li.gfield").hide(),j.closest("li.gfield").hide(),Q.closest("li.gfield").hide()),u.unbind("change").change((function(){var e=a(this).val().replace(/\D/g,"");if(11==e.length){var _={action:"itsg_gf_abnlookup_check_ajax",abn:e};i&&4!==i.readyState&&i.abort(),i=function(e){return a.ajax({type:"POST",url:s,data:e,tryCount:0,retryLimit:c,beforeSend:function(){h.hide(),f.html(t),y.val(d+" ... "),f.addClass("loading"),f.removeClass("error Active Cancelled validation_message")},success:function(e){if(void 0!==e)try{y.val(r);var a=JSON.parse(e);if(null!=a.exception)h.hide(),"Search text is not a valid ABN or ACN"==a.exception.exceptionDescription?f.html(o):f.text(a.exception.exceptionDescription),f.removeClass("Active Cancelled loading"),f.addClass("error validation_message"),v.hide(),k.hide(),x.hide(),N.hide(),A.hide(),D.hide(),j.hide(),Q.hide(),C.val("").change(),E.val("").change(),w.val("").change(),S.val("").change(),T.val("").change(),F.val("").change(),B.val("").change(),m.prop("disabled",!1),b.prop("disabled",!1),m.prop("checked",!1).change().keyup(),b.prop("checked",!1).change().keyup(),C.prop("readonly",!1),E.prop("readonly",!1),w.prop("readonly",!1),S.prop("readonly",!1),T.prop("readonly",!1),F.prop("readonly",!1),B.prop("readonly",!1);else if(null!=a.businessEntity){var i=a.businessEntity.entityType.entityTypeCode,s=a.businessEntity.entityType.entityDescription,t=a.businessEntity.entityStatus.entityStatusCode,n=a.businessEntity.mainBusinessPhysicalAddress.postcode,l=a.businessEntity.mainBusinessPhysicalAddress.stateCode,d=a.businessEntity.entityStatus.effectiveFrom,_=("0"+(u=new Date(d)).getDate()).slice(-2),p=("0"+(u.getMonth()+1)).slice(-2),g=u.getFullYear();if(F.hasClass("dmy"))var c=_+"/"+p+"/"+g;else c=F.hasClass("dmy_dash")?_+"-"+p+"-"+g:F.hasClass("dmy_dot")?_+"."+p+"."+g:F.hasClass("ymd_slash")?g+"/"+p+"/"+u:F.hasClass("ymd_dash")?g+"-"+p+"-"+u:F.hasClass("ymd_dot")?g+"."+p+"."+u:p+"/"+_+"/"+g;if(null!=a.businessEntity.goodsAndServicesTax){var u,P=a.businessEntity.goodsAndServicesTax.effectiveFrom;if(_=("0"+(u=new Date(P)).getDate()).slice(-2),p=("0"+(u.getMonth()+1)).slice(-2),g=u.getFullYear(),F.hasClass("dmy"))var G=_+"/"+p+"/"+g;else G=B.hasClass("dmy_dash")?_+"-"+p+"-"+g:B.hasClass("dmy_dot")?_+"."+p+"."+g:B.hasClass("ymd_slash")?g+"/"+p+"/"+u:B.hasClass("ymd_dash")?g+"-"+p+"-"+u:B.hasClass("ymd_dot")?g+"."+p+"."+u:p+"/"+_+"/"+g;B.val(G).change(),B.prop("readonly",!0),Q.show()}else Q.hide(),B.val("").change();if("IND"==i)var L=("string"==typeof a.businessEntity.legalName.familyName?a.businessEntity.legalName.familyName:"")+", "+("string"==typeof a.businessEntity.legalName.givenName?a.businessEntity.legalName.givenName:"")+" "+("string"==typeof a.businessEntity.legalName.otherGivenName?a.businessEntity.legalName.otherGivenName:"");else L=a.businessEntity.mainName.organisationName;h.hide(),f.text(t+" - "+L),C.val(s).change(),C.prop("readonly",!0),E.val(t).change(),E.prop("readonly",!0),w.val(L).change(),w.prop("readonly",!0),S.val(n).change(),S.prop("readonly",!0),T.val(l).change(),T.prop("readonly",!0),F.val(c).change(),F.prop("readonly",!0),f.removeClass("error loading validation_message"),f.addClass(t),null!=a.businessEntity.goodsAndServicesTax&&"0001-01-01"==a.businessEntity.goodsAndServicesTax.effectiveTo?(m.prop("checked",!0).click().change().keyup(),m.prop("disabled",!1),b.prop("disabled",!0)):(b.prop("checked",!0).click().change().keyup(),b.prop("disabled",!1),m.prop("disabled",!0)),v.show(),k.show(),N.show(),x.show(),A.show(),D.show(),j.show()}}catch(e){f.text(e),f.removeClass("loading Active Cancelled"),f.addClass("error validation_message")}},error:function(e,i,s){if("timeout"==i){if(this.tryCount++,this.tryCount<=this.retryLimit)return void a.ajax(this);f.text(n)}else f.text(e.responseText);y.val(r),f.removeClass("loading Active Cancelled"),f.addClass("error validation_message")},timeout:g})}(_)}else v.hide(),k.hide(),x.hide(),N.hide(),A.hide(),D.hide(),j.hide(),Q.hide(),C.val("").change(),E.val("").change(),w.val("").change(),S.val("").change(),T.val("").change(),F.val("").change(),B.val("").change(),m.prop("disabled",!1),b.prop("disabled",!1),m.prop("checked",!1).change().keyup(),b.prop("checked",!1).change().keyup(),h.hide(),f.html(l),f.addClass("error validation_message"),f.removeClass("loading Active Cancelled")}))}(jQuery)}jQuery(document).ready((function(e){var a=gf_abnlookup_settings.abnlookup_fields,i=gf_abnlookup_settings.form_id;for(var s in a){var t=s;jQuery("#input_"+i+"_"+t).unbind("keydown").keydown((function(e){13!=e.which&&13!=e.keyCode||(e.preventDefault(),jQuery(this).trigger("change"))})),jQuery("#input_"+i+"_"+t).on("change keyup",(function(e){var i=a[s].validate,o=a[s].dateFormat;void 0!==i&&itsg_gf_abnlookup_function(t,i,o)}))}}));