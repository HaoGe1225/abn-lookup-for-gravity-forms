function itsg_gf_abnlookup_function(e,i,a){var s=gf_abnlookup_settings.ajax_url,o=gf_abnlookup_settings.validation_message_loading,n=gf_abnlookup_settings.validation_message_not_valid,t=gf_abnlookup_settings.validation_message_error_communicating,l=gf_abnlookup_settings.validation_message_11_char,r=gf_abnlookup_settings.text_checking,_=gf_abnlookup_settings.text_check_abn,d=gf_abnlookup_settings.gst_value_yes,p=gf_abnlookup_settings.gst_value_no,u=gf_abnlookup_settings.lookup_timeout,g=gf_abnlookup_settings.lookup_retries;!function(i){"use strict";var a=!1,y=jQuery(".gform_abnlookup_field_"+e+' input[type="text"]'),c=jQuery(".gform_abnlookup_field_"+e+" .gfield_description.validation_message"),f=jQuery(".itsg_abnlookup_response_"+e),h=jQuery(".itsg_abnlookup_checkabn_"+e),v=jQuery(".gform_abnlookup_entity_gst_field_"+e),m=jQuery(".gform_abnlookup_entity_gst_field_"+e+' input[value="'+d+'"]'),b=jQuery(".gform_abnlookup_entity_gst_field_"+e+' input[value="'+p+'"]'),k=jQuery(".gform_abnlookup_entity_type_field_"+e),j=jQuery(".gform_abnlookup_entity_type_field_"+e+" input"),C=jQuery(".gform_abnlookup_entity_status_field_"+e),Q=jQuery(".gform_abnlookup_entity_status_field_"+e+" input"),x=jQuery(".gform_abnlookup_entity_name_field_"+e),N=jQuery(".gform_abnlookup_entity_name_field_"+e+" input"),E=jQuery(".gform_abnlookup_entity_postcode_field_"+e),w=jQuery(".gform_abnlookup_entity_postcode_field_"+e+" input"),A=jQuery(".gform_abnlookup_entity_state_field_"+e),S=jQuery(".gform_abnlookup_entity_state_field_"+e+" input"),D=jQuery(".gform_abnlookup_entity_effective_from_field_"+e),T=jQuery(".gform_abnlookup_entity_effective_from_field_"+e+" input"),F=jQuery(".gform_abnlookup_gst_effective_from_field_"+e),O=jQuery(".gform_abnlookup_gst_effective_from_field_"+e+" input"),B=jQuery(".gform_abnlookup_business_name_field_"+e),P=jQuery(".gform_abnlookup_business_name_field_"+e+" select");jQuery(".gform_abnlookup_business_name_field_"+e+" option");""!==f.html()?((m.is(":visible")&&1!=m.prop("checked")&&1!=b.prop("checked")||j.is(":visible")&&""==j.val()||Q.is(":visible")&&""==Q.val()||N.is(":visible")&&""==N.val()||w.is(":visible")&&""==w.val()||S.is(":visible")&&""==S.val()||T.is(":visible")&&""==T.val()||P.is(":visible")&&""==P.val()||O.is(":visible")&&""==O.val())&&y.trigger("change"),m.is(":checked")?b.prop("disabled",!0):b.is(":checked")&&m.prop("disabled",!0),j.prop("readonly",!0),Q.prop("readonly",!0),N.prop("readonly",!0),w.prop("readonly",!0),S.prop("readonly",!0),T.prop("readonly",!0),O.prop("readonly",!0)):(v.closest("li.gfield").hide(),k.closest("li.gfield").hide(),C.closest("li.gfield").hide(),x.closest("li.gfield").hide(),E.closest("li.gfield").hide(),A.closest("li.gfield").hide(),D.closest("li.gfield").hide(),F.closest("li.gfield").hide(),B.closest("li.gfield").hide()),y.unbind("change").change((function(){var d=jQuery(this).val().replace(/\D/g,"");if(11==d.length){var p={action:"itsg_gf_abnlookup_check_ajax",abn:d};a&&4!==a.readyState&&a.abort(),a=function(a){return i.ajax({type:"POST",url:s,data:a,tryCount:0,retryLimit:g,beforeSend:function(){c.hide(),f.html(o),h.val(r+" ... "),f.addClass("loading"),f.removeClass("error Active Cancelled validation_message")},success:function(i){if(void 0!==i)try{h.val(_);var a=JSON.parse(i);if(null!=a.exception)c.hide(),"Search text is not a valid ABN or ACN"==a.exception.exceptionDescription?f.html(n):f.text(a.exception.exceptionDescription),f.removeClass("Active Cancelled loading"),f.addClass("error validation_message"),v.hide(),k.hide(),C.hide(),x.hide(),E.hide(),A.hide(),D.hide(),F.hide(),B.hide(),j.val("").change(),Q.val("").change(),N.val("").change(),w.val("").change(),S.val("").change(),T.val("").change(),O.val("").change(),jQuery(".gform_abnlookup_business_name_field_"+e+" option").remove(),m.prop("disabled",!1),b.prop("disabled",!1),m.prop("checked",!1).change().keyup(),b.prop("checked",!1).change().keyup(),j.prop("readonly",!1),Q.prop("readonly",!1),N.prop("readonly",!1),w.prop("readonly",!1),S.prop("readonly",!1),T.prop("readonly",!1),O.prop("readonly",!1);else if(null!=a.businessEntity202001){var s=a.businessEntity202001.entityType.entityTypeCode,o=a.businessEntity202001.entityType.entityDescription,t=a.businessEntity202001.entityStatus.entityStatusCode,l=a.businessEntity202001.mainBusinessPhysicalAddress.postcode,r=a.businessEntity202001.mainBusinessPhysicalAddress.stateCode,d=a.businessEntity202001.entityStatus.effectiveFrom,p=a.businessEntity202001.businessName,u=("0"+(L=new Date(d)).getDate()).slice(-2),g=("0"+(L.getMonth()+1)).slice(-2),y=L.getFullYear();if(T.hasClass("dmy"))var G=u+"/"+g+"/"+y;else G=T.hasClass("dmy_dash")?u+"-"+g+"-"+y:T.hasClass("dmy_dot")?u+"."+g+"."+y:T.hasClass("ymd_slash")?y+"/"+g+"/"+L:T.hasClass("ymd_dash")?y+"-"+g+"-"+L:T.hasClass("ymd_dot")?y+"."+g+"."+L:g+"/"+u+"/"+y;if(null!=a.businessEntity202001.goodsAndServicesTax){var L,M=a.businessEntity202001.goodsAndServicesTax.effectiveFrom;if(u=("0"+(L=new Date(M)).getDate()).slice(-2),g=("0"+(L.getMonth()+1)).slice(-2),y=L.getFullYear(),T.hasClass("dmy"))var Y=u+"/"+g+"/"+y;else Y=O.hasClass("dmy_dash")?u+"-"+g+"-"+y:O.hasClass("dmy_dot")?u+"."+g+"."+y:O.hasClass("ymd_slash")?y+"/"+g+"/"+L:O.hasClass("ymd_dash")?y+"-"+g+"-"+L:O.hasClass("ymd_dot")?y+"."+g+"."+L:g+"/"+u+"/"+y;O.val(Y).change(),O.prop("readonly",!0),F.show()}else F.hide(),O.val("").change();if("IND"==s)var I=("string"==typeof a.businessEntity202001.legalName.familyName?a.businessEntity202001.legalName.familyName:"")+", "+("string"==typeof a.businessEntity202001.legalName.givenName?a.businessEntity202001.legalName.givenName:"")+" "+("string"==typeof a.businessEntity202001.legalName.otherGivenName?a.businessEntity202001.legalName.otherGivenName:"");else I=a.businessEntity202001.mainName.organisationName;if(void 0!==p){jQuery(".gform_abnlookup_business_name_field_"+e+" option").remove();var J=new Option(I,I,!0,!0);P.append(J),p.forEach((function(e,i,a){var s=new Option(e.organisationName,e.organisationName,!1,!1);P.append(s)}))}else jQuery(".gform_abnlookup_business_name_field_"+e+" option").remove(),J=new Option(I,I,!0,!0),P.append(J);c.hide(),f.text(t+" - "+I),j.val(o).change(),j.prop("readonly",!0),Q.val(t).change(),Q.prop("readonly",!0),N.val(I).change(),N.prop("readonly",!0),w.val(l).change(),w.prop("readonly",!0),S.val(r).change(),S.prop("readonly",!0),T.val(G).change(),T.prop("readonly",!0),f.removeClass("error loading validation_message"),f.addClass(t),null!=a.businessEntity202001.goodsAndServicesTax&&"0001-01-01"==a.businessEntity202001.goodsAndServicesTax.effectiveTo?(m.prop("checked",!0).click().change().keyup(),m.prop("disabled",!1),b.prop("disabled",!0)):(b.prop("checked",!0).click().change().keyup(),b.prop("disabled",!1),m.prop("disabled",!0)),v.show(),k.show(),x.show(),C.show(),E.show(),A.show(),D.show(),B.show()}}catch(e){f.text(e),f.removeClass("loading Active Cancelled"),f.addClass("error validation_message")}},error:function(e,a,s){if("timeout"==a){if(this.tryCount++,this.tryCount<=this.retryLimit)return void i.ajax(this);f.text(t)}else f.text(e.responseText);h.val(_),f.removeClass("loading Active Cancelled"),f.addClass("error validation_message")},timeout:u})}(p)}else v.hide(),k.hide(),C.hide(),x.hide(),E.hide(),A.hide(),D.hide(),F.hide(),B.hide(),j.val("").change(),Q.val("").change(),N.val("").change(),w.val("").change(),S.val("").change(),T.val("").change(),jQuery(".gform_abnlookup_business_name_field_"+e+" option").remove(),O.val("").change(),m.prop("disabled",!1),b.prop("disabled",!1),m.prop("checked",!1).change().keyup(),b.prop("checked",!1).change().keyup(),c.hide(),f.html(l),f.addClass("error validation_message"),f.removeClass("loading Active Cancelled")}))}(jQuery)}jQuery(document).ready((function(e){var i=gf_abnlookup_settings.abnlookup_fields,a=gf_abnlookup_settings.form_id;for(var s in i){var o=s;jQuery("#input_"+a+"_"+o).unbind("keydown").keydown((function(e){13!=e.which&&13!=e.keyCode||(e.preventDefault(),jQuery(this).trigger("change"))})),jQuery("#input_"+a+"_"+o).unbind("keyup").keyup((function(e){13!=e.which&&13!=e.keyCode||e.preventDefault()})),jQuery("#input_"+a+"_"+o).on("change keyup",(function(e){var a=i[s].validate,n=i[s].dateFormat;void 0!==a&&itsg_gf_abnlookup_function(o,a,n)}))}}));