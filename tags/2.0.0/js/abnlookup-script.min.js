function itsg_gf_abnlookup_function(e,i,a){var s=gf_abnlookup_settings.ajax_url,t=gf_abnlookup_settings.validation_message_loading,o=gf_abnlookup_settings.validation_message_not_valid,n=gf_abnlookup_settings.validation_message_error_communicating,l=gf_abnlookup_settings.validation_message_11_char,d=gf_abnlookup_settings.text_checking,r=gf_abnlookup_settings.text_check_abn,_=gf_abnlookup_settings.gst_value_yes,p=gf_abnlookup_settings.gst_value_no,g=gf_abnlookup_settings.lookup_timeout,c=gf_abnlookup_settings.lookup_retries;!function(i){"use strict";var a=!1,h=i(".gform_abnlookup_field_"+e+' input[type="text"]'),u=i(".gform_abnlookup_field_"+e+" .gfield_description.validation_message"),f=i(".itsg_abnlookup_response_"+e),y=i(".itsg_abnlookup_checkabn_"+e),v=i(".gform_abnlookup_entity_gst_field_"+e),m=i(".gform_abnlookup_entity_gst_field_"+e+' input[value="'+_+'"]'),b=i(".gform_abnlookup_entity_gst_field_"+e+' input[value="'+p+'"]'),k=i(".gform_abnlookup_entity_type_field_"+e),C=i(".gform_abnlookup_entity_type_field_"+e+" input"),x=i(".gform_abnlookup_entity_status_field_"+e),E=i(".gform_abnlookup_entity_status_field_"+e+" input"),N=i(".gform_abnlookup_entity_name_field_"+e),w=i(".gform_abnlookup_entity_name_field_"+e+" input"),A=i(".gform_abnlookup_entity_postcode_field_"+e),S=i(".gform_abnlookup_entity_postcode_field_"+e+" input"),D=i(".gform_abnlookup_entity_state_field_"+e),T=i(".gform_abnlookup_entity_state_field_"+e+" input"),j=i(".gform_abnlookup_entity_effective_from_field_"+e),F=i(".gform_abnlookup_entity_effective_from_field_"+e+" input"),P=i(".gform_abnlookup_gst_effective_from_field_"+e),Q=i(".gform_abnlookup_gst_effective_from_field_"+e+" input");""!==f.html()?((m.is(":visible")&&1!=m.prop("checked")&&1!=b.prop("checked")||C.is(":visible")&&""==C.val()||E.is(":visible")&&""==E.val()||w.is(":visible")&&""==w.val()||S.is(":visible")&&""==S.val()||T.is(":visible")&&""==T.val()||F.is(":visible")&&""==F.val()||Q.is(":visible")&&""==Q.val())&&h.trigger("change"),m.is(":checked")?b.prop("disabled",!0):b.is(":checked")&&m.prop("disabled",!0),C.prop("readonly",!0),E.prop("readonly",!0),w.prop("readonly",!0),S.prop("readonly",!0),T.prop("readonly",!0),F.prop("readonly",!0),Q.prop("readonly",!0)):(v.closest("li.gfield").hide(),k.closest("li.gfield").hide(),x.closest("li.gfield").hide(),N.closest("li.gfield").hide(),A.closest("li.gfield").hide(),D.closest("li.gfield").hide(),j.closest("li.gfield").hide(),P.closest("li.gfield").hide()),h.unbind("change").change((function(){var e=i(this).val().replace(/\D/g,"");if(11==e.length){var _={action:"itsg_gf_abnlookup_check_ajax",abn:e};a&&4!==a.readyState&&a.abort(),a=function(e){return i.ajax({type:"POST",url:s,data:e,tryCount:0,retryLimit:c,beforeSend:function(){u.hide(),f.html(t),y.val(d+" ... "),f.addClass("loading"),f.removeClass("error Active Cancelled validation_message")},success:function(e){if(void 0!==e)try{y.val(r);var i=JSON.parse(e);if(null!=i.exception)u.hide(),"Search text is not a valid ABN or ACN"==i.exception.exceptionDescription?f.html(o):f.text(i.exception.exceptionDescription),f.removeClass("Active Cancelled loading"),f.addClass("error validation_message"),v.hide(),k.hide(),x.hide(),N.hide(),A.hide(),D.hide(),j.hide(),P.hide(),C.val("").change(),E.val("").change(),w.val("").change(),S.val("").change(),T.val("").change(),F.val("").change(),Q.val("").change(),m.prop("disabled",!1),b.prop("disabled",!1),m.prop("checked",!1).change().keyup(),b.prop("checked",!1).change().keyup(),C.prop("readonly",!1),E.prop("readonly",!1),w.prop("readonly",!1),S.prop("readonly",!1),T.prop("readonly",!1),F.prop("readonly",!1),Q.prop("readonly",!1);else if(null!=i.businessEntity){var a=i.businessEntity.entityType.entityTypeCode,s=i.businessEntity.entityType.entityDescription,t=i.businessEntity.entityStatus.entityStatusCode,n=i.businessEntity.mainBusinessPhysicalAddress.postcode,l=i.businessEntity.mainBusinessPhysicalAddress.stateCode,d=i.businessEntity.entityStatus.effectiveFrom,_=("0"+(h=new Date(d)).getDate()).slice(-2),p=("0"+(h.getMonth()+1)).slice(-2),g=h.getFullYear();if(F.hasClass("dmy"))var c=_+"/"+p+"/"+g;else c=F.hasClass("dmy_dash")?_+"-"+p+"-"+g:F.hasClass("dmy_dot")?_+"."+p+"."+g:F.hasClass("ymd_slash")?g+"/"+p+"/"+h:F.hasClass("ymd_dash")?g+"-"+p+"-"+h:F.hasClass("ymd_dot")?g+"."+p+"."+h:p+"/"+_+"/"+g;if(null!=i.businessEntity.goodsAndServicesTax){var h,B=i.businessEntity.goodsAndServicesTax.effectiveFrom;if(_=("0"+(h=new Date(B)).getDate()).slice(-2),p=("0"+(h.getMonth()+1)).slice(-2),g=h.getFullYear(),F.hasClass("dmy"))var O=_+"/"+p+"/"+g;else O=Q.hasClass("dmy_dash")?_+"-"+p+"-"+g:Q.hasClass("dmy_dot")?_+"."+p+"."+g:Q.hasClass("ymd_slash")?g+"/"+p+"/"+h:Q.hasClass("ymd_dash")?g+"-"+p+"-"+h:Q.hasClass("ymd_dot")?g+"."+p+"."+h:p+"/"+_+"/"+g;Q.val(O).change(),Q.prop("readonly",!0),P.show()}else P.hide(),Q.val("").change();if("IND"==a)var G=("string"==typeof i.businessEntity.legalName.familyName?i.businessEntity.legalName.familyName:"")+", "+("string"==typeof i.businessEntity.legalName.givenName?i.businessEntity.legalName.givenName:"")+" "+("string"==typeof i.businessEntity.legalName.otherGivenName?i.businessEntity.legalName.otherGivenName:"");else G=i.businessEntity.mainName.organisationName;u.hide(),f.text(t+" - "+G),C.val(s).change(),C.prop("readonly",!0),E.val(t).change(),E.prop("readonly",!0),w.val(G).change(),w.prop("readonly",!0),S.val(n).change(),S.prop("readonly",!0),T.val(l).change(),T.prop("readonly",!0),F.val(c).change(),F.prop("readonly",!0),f.removeClass("error loading validation_message"),f.addClass(t),null!=i.businessEntity.goodsAndServicesTax&&"0001-01-01"==i.businessEntity.goodsAndServicesTax.effectiveTo?(m.prop("checked",!0).click().change().keyup(),m.prop("disabled",!1),b.prop("disabled",!0)):(b.prop("checked",!0).click().change().keyup(),b.prop("disabled",!1),m.prop("disabled",!0)),v.show(),k.show(),N.show(),x.show(),A.show(),D.show(),j.show()}}catch(e){f.text(e),f.removeClass("loading Active Cancelled"),f.addClass("error validation_message")}},error:function(e,a,s){if("timeout"==a){if(this.tryCount++,this.tryCount<=this.retryLimit)return void i.ajax(this);f.text(n)}else f.text(e.responseText);y.val(r),f.removeClass("loading Active Cancelled"),f.addClass("error validation_message")},timeout:g})}(_)}else v.hide(),k.hide(),x.hide(),N.hide(),A.hide(),D.hide(),j.hide(),P.hide(),C.val("").change(),E.val("").change(),w.val("").change(),S.val("").change(),T.val("").change(),F.val("").change(),Q.val("").change(),m.prop("disabled",!1),b.prop("disabled",!1),m.prop("checked",!1).change().keyup(),b.prop("checked",!1).change().keyup(),u.hide(),f.html(l),f.addClass("error validation_message"),f.removeClass("loading Active Cancelled")}))}(jQuery)}jQuery(document).bind("gform_post_render gform_post_conditional_logic",(function(e){var i=gf_abnlookup_settings.abnlookup_fields,a=gf_abnlookup_settings.form_id;for(var s in i)if(i.hasOwnProperty(s)){var t=s,o=i[s].validate,n=i[s].dateFormat;void 0!==o&&(itsg_gf_abnlookup_function(t,o,n),jQuery("#input_"+a+"_"+t).unbind("keydown").keydown((function(e){13!=e.which&&13!=e.keyCode||(e.preventDefault(),jQuery(this).trigger("change"))})))}}));